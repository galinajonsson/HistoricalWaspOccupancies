---
title: "Format and Model Data"
author: "Galina M. JÃ¶nsson"
date: "17/01/2020"
output: 
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
---

Here I will format the data for the 12 models with varying spatial (1, 2, 5 and 10 km grid cells) and temporal (1, 5 or 10 year TPs) resolutions. Please note that I will describe each step in detail for model 1 and omitt any repeated descriptions in the formatting of subsequent models. 

First I will load the cleaned NHM and BWARS data
```{r load-cleanDat, echo=TRUE, message=FALSE, warning=FALSE}
# Load the tidied NHM and BWARS data seperately
NHMdat <- read.csv('../data/cleanData/NHMclean.csv', header=TRUE, na.strings=c("","NA"))
BWARSdat <- read.csv('../data/cleanData/BWARSclean.csv', header=TRUE, na.strings=c("","NA"))
```


... and create an empty dataframe to fill in values
I will create two empty data frames into which I can enter the results from the models. The first data frame (modelSumDF) will contain information on each model and the second (sppModelSumDF) will contain information on the spcies. 
```{r create-emptyDF, cache=TRUE, message=FALSE}
### Create model data frame
#
modelSumDF <- data.frame(model=factor(c("Model 1", "Model 2", "Model 3","Model 4", "Model 5", "Model 6", "Model 7", "Model 8", "Model 9","Model 10", "Model 11", "Model 12")),
                             closurePer=factor(c("1yr", "5yrs", "10yrs","1yr", "5yrs", "10yrs")),
                             spatialRes=factor(rep(c("1x1km", "2x2km", "5x5km", "10x10km"), times = c(3,3,3,3))),
                             nClosurePer=numeric(12),
                             nVisits=numeric(12),
                             nsites=numeric(12)) 
#Replace zeroes with NAs
modelSumDF[ modelSumDF == 0 ] <- NA 

### Create species data frame!
sppModelSumDF <- data.frame(model=factor(rep(c("Model 1", "Model 2", "Model 3","Model 4", "Model 5", "Model 6", "Model 7", "Model 8", "Model 9","Model 10", "Model 11", "Model 12"), times = c(3,3,3,3,3,3,3,3,3,3,3,3))),
                               closurePer=factor(rep(c("1yr", "5yrs", "10yrs", "1yr", "5yrs", "10yrs", "1yr", "5yrs", "10yrs", "1yr", "5yrs", "10yrs"), times = c(3,3,3,3,3,3,3,3,3,3,3,3))),
                               spatialRes=factor(rep(c("1x1km", "2x2km", "5x5km", "10x10km"), times = c(9,9,9,9))),
                               Species=factor((rep(c("Vespula vulgaris", "Vespula germanica", "Vespa crabro"), times = c(12)))),
                               nSpeciesSites=numeric(36),
                               nSpeciesObs=numeric(36),
                               alphaPrec=numeric(36),
                               alphaPPrec=numeric(36),
                               DIC=numeric(36))

#Replace zeroes with NAs
sppModelSumDF[ sppModelSumDF == 0 ] <- NA 
```


## Model 1 (1 yr + 1km^^2)
##### Survey: date (dd/mm/yyyy)xGridCell
##### Closure period: 1 year
##### Grid cell: 1x1 km

### Format
I will first format the NHM and BWARS datasets (now only containing sites that have been visited at two or more ten year closure periods) separately. 

The package "sparta" divides the data into different data types (DTs) depending on the list length of each observation. By default, "sparta" has three different DTs, which are treated as independent realisations of the same underlying state with no inherent order of importance. The package translates a list length of 1 (one species observed at any given visit) into DT 1, a list length of 2-3 into DT 2 and a list length of 4 or more into DT 3. I want the model to treat BWARS data and the NHM data as different DTs since these data are collected in different ways. Given that I have a maximum of three species per visit in both the NHM and BWARS datasets, the maximum list length in either of these datasets will be 3 and none of the two datasets will contain DT 3 (list length of 4 or more). I will not change the list length of the BWARS dataset in order for the data it contains to translate into either DT 1 (list length 1) or DT 2 (list length 2-3) in the final model that will contain both the NHM and BWARS datasets. For the NHM dataset, I will change the list length of every visit to a number larger than 4 so that it will be translated into DT 3 in the final model.
```{r model1-format, echo=TRUE, message=FALSE, warning=FALSE}
######### Format the NHM data #########
formattedOccData_NHM <- sparta::formatOccData(taxa = NHMdat$species, 
                                              site = NHMdat$km1grid, 
                                              survey= paste(NHMdat$km1grid,NHMdat$date),       
                                              closure_period = NHMdat$year)

######### Format the BWARS data #########
formattedOccData_BWARS <- sparta::formatOccData(taxa = BWARSdat$species, 
                                                site = BWARSdat$km1grid, 
                                                survey= paste(BWARSdat$km1grid,BWARSdat$date),
                                                closure_period = BWARSdat$year)

# Change the list length of the formatted NHM data by assigning all values less than 4 (every value because the maximum list length is 3) a value of 10.
formattedOccData_NHM$occDetdata$L[formattedOccData_NHM$occDetdata$L<4] <- 10

# Merge the formated NHM data with the formatted BWARS data. Each contains two list and I will merge the two lists of the two datasets separately. 
occDetdata_merged_1kmgrid_date_year <- rbind(formattedOccData_NHM$occDetdata, formattedOccData_BWARS$occDetdata)
spp_vis_merged_1kmgrid_date_year <- rbind(formattedOccData_NHM$spp_vis, formattedOccData_BWARS$spp_vis)

#Save files
#write.csv(occDetdata_merged_1kmgrid_date_year, '../outputs/formattedData/occDetdata_merged_1kmgrid_date_year.csv')
#write.csv(spp_vis_merged_1kmgrid_date_year, '../outputs/formattedData/spp_vis_merged_1kmgrid_date_year.csv')
```


### Model

Load formatted data
```{r load-model1-data, message=FALSE, warning=FALSE, echo=TRUE}
occDetdata_merged_1kmgrid_date_year <- read.csv('../outputs/formattedData/occDetdata_merged_1kmgrid_date_year.csv', header=T, na.strings=c("","NA"))
spp_vis_merged_1kmgrid_date_year <- read.csv('../outputs/formattedData/spp_vis_merged_1kmgrid_date_year.csv', header=T, na.strings=c("","NA"))
```

#### Model 1a: Vespula vulgaris
```{r model1a-vulgaris, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_1kmgrid_date_year_vv <- sparta::occDetFunc(taxa_name = "Vespula.vulgaris",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_1kmgrid_date_year,
                      spp_vis = spp_vis_merged_1kmgrid_date_year,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_1kmgrid_date_year_vv, "../outputs/modelOutputs/results_1kmgrid_date_year_vv.rds")
```

Find results of interest and enter into modelSumDF and sppModelSumDF. I will only show this here but also do it for all other models and species. 
```{r model1a-results, cache=TRUE}
# Read model output
results_1kmgrid_date_year_vv <- readRDS("../outputs/modelOutputs/results_1kmgrid_date_year_vv.rds")

### Model results (modelSumDF)
# n Closure periods
modelSumDF[1, 4] <-(results_1kmgrid_date_year_vv$max_year)
# n Visits
modelSumDF[1, 5] <-(results_1kmgrid_date_year_vv$nvisits)
# n Sites
modelSumDF[1, 6] <-(results_1kmgrid_date_year_vv$nsites)


### Species results (sppModelSumDF)
# n species sites
sppModelSumDF[1, 5] <- (results_1kmgrid_date_year_vv$species_sites) 
# n species observations
sppModelSumDF[1, 6] <- (results_1kmgrid_date_year_vv$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_1kmgrid_date_year_vv$BUGSoutput$summary)
sppModelSumDF[1, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 1.528821
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[1, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 7.961708
#DIC
sppModelSumDF[1, 9] <- (results_1kmgrid_date_year_vv$BUGSoutput$DIC) 
```


#### Model 1b: Vespula germaica
```{r model1b-germanica, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_1kmgrid_date_year_vg <- sparta::occDetFunc(taxa_name = "Vespula.germanica",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_1kmgrid_date_year,
                      spp_vis = spp_vis_merged_1kmgrid_date_year,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_1kmgrid_date_year_vg, "../outputs/modelOutputs/results_1kmgrid_date_year_vg.rds")
```


Find results of interest and enter into modelSumDF and sppModelSumDF
```{r model1b-results, cache=TRUE}
results_1kmgrid_date_year_vg <- readRDS("../outputs/modelOutputs/results_1kmgrid_date_year_vg.rds")

# n species sites
sppModelSumDF[2, 5] <- (results_1kmgrid_date_year_vg$species_sites) 
# n species observations
sppModelSumDF[2, 6] <- (results_1kmgrid_date_year_vg$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_1kmgrid_date_year_vg$BUGSoutput$summary)
sppModelSumDF[2, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 1.528821
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[2, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 7.961708
# DIC
sppModelSumDF[2, 9] <- (results_1kmgrid_date_year_vg$BUGSoutput$DIC)
```






#### Model 1c: Vespa crabro
```{r model1c-crabro, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_1kmgrid_date_year_vc <- sparta::occDetFunc(taxa_name = "Vespa.crabro",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_1kmgrid_date_year,
                      spp_vis = spp_vis_merged_1kmgrid_date_year,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_1kmgrid_date_year_vc, "../outputs/modelOutputs/results_1kmgrid_date_year_vc.rds")
```


```{r model1c-results, cache=TRUE, message=FALSE}
results_1kmgrid_date_year_vc <- readRDS("../outputs/modelOutputs/results_1kmgrid_date_year_vc.rds")

# n species sites
sppModelSumDF[3, 5] <- (results_1kmgrid_date_year_vc$species_sites) 
# n species observations
sppModelSumDF[3, 6] <- (results_1kmgrid_date_year_vc$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_1kmgrid_date_year_vc$BUGSoutput$summary)
sppModelSumDF[3, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[3, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# DIC
sppModelSumDF[3, 9] <- (results_1kmgrid_date_year_vc$BUGSoutput$DIC)
```




## Model 2 (5 yrs + 1km^^2)
##### Survey: date (dd/mm/yyyy)
##### Closure period: five years
##### Grid cell: 1x1 km

### Format
```{r model2-format, echo=TRUE, message=FALSE, warning=FALSE}
############# Format the NHM data #############
formattedOccData_NHM <- sparta::formatOccData(taxa = NHMdat$species, 
                                              site = NHMdat$km1grid, 
                                              survey= paste(NHMdat$km1grid,NHMdat$date),                                 
                                              closure_period = NHMdat$tp5)

############# Format the BWARS data #############
formattedOccData_BWARS <- sparta::formatOccData(taxa = BWARSdat$species, 
                                                site = BWARSdat$km1grid, 
                                                survey= paste(BWARSdat$km1grid,BWARSdat$date),
                                                closure_period = BWARSdat$tp5)

# Change the list length of the formatted NHM data bu assigning all values less than 4 (every value because the maximum list length is 3) a value of 10.
formattedOccData_NHM$occDetdata$L[formattedOccData_NHM$occDetdata$L<4] <- 10


# Merge the formated NHM data with the formatted BWARS data. Each contains two list and I will merge the two lists of the two datasets separately. 
occDetdata_merged_1kmgrid_date_5years <- rbind(formattedOccData_NHM$occDetdata, formattedOccData_BWARS$occDetdata)
spp_vis_merged_1kmgrid_date_5years <- rbind(formattedOccData_NHM$spp_vis, formattedOccData_BWARS$spp_vis)

#Save files
#write.csv(occDetdata_merged_1kmgrid_date_5years, '../outputs/formattedData/occDetdata_merged_1kmgrid_date_5years.csv')
#write.csv(spp_vis_merged_1kmgrid_date_5years, '../outputs/formattedData/spp_vis_merged_1kmgrid_date_5years.csv')
```


### Model
Load the formatted data
```{r load-model2-data, cache=TRUE, message=FALSE}
# Load data
occDetdata_merged_1kmgrid_date_5years <- read.csv('../outputs/formattedData/occDetdata_merged_1kmgrid_date_5years.csv', header=T, na.strings=c("","NA"))

spp_vis_merged_1kmgrid_date_5years <- read.csv('../outputs/formattedData/spp_vis_merged_1kmgrid_date_5years.csv', header=T, na.strings=c("","NA"))
```


#### Model 2a: Vespula vulgaris
```{r model2a-vulgaris, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_1kmgrid_date_5years_vv <- sparta::occDetFunc(taxa_name = "Vespula.vulgaris",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_1kmgrid_date_5years,
                      spp_vis = spp_vis_merged_1kmgrid_date_5years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_1kmgrid_date_5years_vv, "../outputs/modelOutputs/results_1kmgrid_date_5years_vv.rds")
```



```{r model2a-results, cache=TRUE}
results_1kmgrid_date_5years_vv <- readRDS("../outputs/modelOutputs/results_1kmgrid_date_5years_vv.rds")
### n Closure periods
modelSumDF[2, 4] <-(results_1kmgrid_date_5years_vv$max_year)
# n Visits
modelSumDF[2, 5] <-(results_1kmgrid_date_5years_vv$nvisits)
# n Sites
modelSumDF[2, 6] <-(results_1kmgrid_date_5years_vv$nsites)


### Species results (sppModelSumDF)
# n species sites
sppModelSumDF[4, 5] <- (results_1kmgrid_date_5years_vv$species_sites) 
# n species observations
sppModelSumDF[4, 6] <- (results_1kmgrid_date_5years_vv$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_1kmgrid_date_5years_vv$BUGSoutput$summary)
sppModelSumDF[4, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[4, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
#DIC
sppModelSumDF[4, 9] <-(results_1kmgrid_date_5years_vv$BUGSoutput$DIC) 
```



#### Model 2b: Vespula germanica
```{r model2b-germanica, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_1kmgrid_date_5years_vg <- sparta::occDetFunc(taxa_name = "Vespula.germanica",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_1kmgrid_date_5years,
                      spp_vis = spp_vis_merged_1kmgrid_date_5years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_1kmgrid_date_5years_vg, "../outputs/modelOutputs/results_1kmgrid_date_5years_vg.rds")
```


```{r model2b-results, cache=TRUE}
results_1kmgrid_date_5years_vg <- readRDS("../outputs/modelOutputs/results_1kmgrid_date_5years_vg.rds")
# n species sites
sppModelSumDF[5, 5] <- (results_1kmgrid_date_5years_vg$species_sites) 
# n species observations
sppModelSumDF[5, 6] <- (results_1kmgrid_date_5years_vg$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_1kmgrid_date_5years_vg$BUGSoutput$summary)
sppModelSumDF[5, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[5, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
#DIC
sppModelSumDF[5, 9] <-(results_1kmgrid_date_5years_vg$BUGSoutput$DIC) 
#
```



#### Model 2c: Vespa crabro

#### Run model
```{r model2c-crabro, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
results_1kmgrid_date_5years_vc <- sparta::occDetFunc(taxa_name = "Vespa.crabro",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_1kmgrid_date_5years,
                      spp_vis = spp_vis_merged_1kmgrid_date_5years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_1kmgrid_date_5years_vc, "../outputs/modelOutputs/results_1kmgrid_date_5years_vc.rds")
```


```{r model2c-results, cache=TRUE}
results_1kmgrid_date_5years_vc <- readRDS("../outputs/modelOutputs/results_1kmgrid_date_5years_vc.rds")
# n species sites
sppModelSumDF[6, 5] <- (results_1kmgrid_date_5years_vc$species_sites) 
# n species observations
sppModelSumDF[6, 6] <- (results_1kmgrid_date_5years_vc$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_1kmgrid_date_5years_vc$BUGSoutput$summary)
sppModelSumDF[6, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[6, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
#DIC
sppModelSumDF[6, 9] <-(results_1kmgrid_date_5years_vc$BUGSoutput$DIC) 
```


## Model 3 (10 yrs + 1km^^2)
##### Survey: date (dd/mm/yyyy)
##### Closure period: ten years
##### Grid cell: 1x1 km

### Format
```{r model3-format, echo=TRUE, message=FALSE, warning=FALSE}
############# Format the NHM data #############
formattedOccData_NHM <- sparta::formatOccData(taxa = NHMdat$species, 
                                              site = NHMdat$km1grid, 
                                              survey= paste(NHMdat$km1grid,NHMdat$date),            
                                              closure_period = NHMdat$tp10)


############# Format the BWARS data #############
formattedOccData_BWARS <- sparta::formatOccData(taxa = BWARSdat$species, 
                                                site = BWARSdat$km1grid, 
                                                survey= paste(BWARSdat$km1grid,BWARSdat$date),
                                                closure_period = BWARSdat$tp10)


# Change the list length of the formatted NHM data bu assigning all values less than 4 (every value because the maximum list length is 3) a value of 10.
formattedOccData_NHM$occDetdata$L[formattedOccData_NHM$occDetdata$L<4] <- 10


# Merge the formated NHM data with the formatted BWARS data. Each contains two list and I will merge the two lists of the two datasets separately. 
occDetdata_merged_1kmgrid_date_10years <- rbind(formattedOccData_NHM$occDetdata, formattedOccData_BWARS$occDetdata)
spp_vis_merged_1kmgrid_date_10years <- rbind(formattedOccData_NHM$spp_vis, formattedOccData_BWARS$spp_vis)

#Save files
#write.csv(occDetdata_merged_1kmgrid_date_10years, '../outputs/formattedData/occDetdata_merged_1kmgrid_date_10years.csv')
#write.csv(spp_vis_merged_1kmgrid_date_10years, '../outputs/formattedData/spp_vis_merged_1kmgrid_date_10years.csv')
```

### Model
Load the formatted data
```{r load-model3-data, cache=TRUE, message=FALSE}
occDetdata_merged_1kmgrid_date_10years <- read.csv('../outputs/formattedData/occDetdata_merged_1kmgrid_date_10years.csv', header=T, na.strings=c("","NA"))
spp_vis_merged_1kmgrid_date_10years <- read.csv('../outputs/formattedData/spp_vis_merged_1kmgrid_date_10years.csv', header=T, na.strings=c("","NA"))
```


#### Model 3a: Vespula vulgaris
```{r model3a-vulgaris, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_1kmgrid_date_10years_vv <- sparta::occDetFunc(taxa_name = "Vespula.vulgaris",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_1kmgrid_date_10years,
                      spp_vis = spp_vis_merged_1kmgrid_date_10years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_1kmgrid_date_10years_vv, "../outputs/modelOutputs/results_1kmgrid_date_10years_vv.rds")
```



```{r model3a-results, cache=TRUE}
results_1kmgrid_date_10years_vv <- readRDS("../outputs/modelOutputs/results_1kmgrid_date_10years_vv.rds")
# n Closure periods
modelSumDF[3, 4] <-(results_1kmgrid_date_10years_vv$max_year)
# n Visits
modelSumDF[3, 5] <-(results_1kmgrid_date_10years_vv$nvisits)
# n Sites
modelSumDF[3, 6] <-(results_1kmgrid_date_10years_vv$nsites)


### Species results (sppModelSumDF)
# n species sites
sppModelSumDF[7, 5] <- (results_1kmgrid_date_10years_vv$species_sites) 
# n species observations
sppModelSumDF[7, 6] <- (results_1kmgrid_date_10years_vv$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_1kmgrid_date_10years_vv$BUGSoutput$summary)
sppModelSumDF[7, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[7, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[7, 9] <-(results_1kmgrid_date_10years_vv$BUGSoutput$DIC) 
```


#### Model 3b: Vespula germanica
```{r model3b-germanica, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_1kmgrid_date_10years_vg <- sparta::occDetFunc(taxa_name = "Vespula.germanica",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_1kmgrid_date_10years,
                      spp_vis = spp_vis_merged_1kmgrid_date_10years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_1kmgrid_date_10years_vg, "../outputs/modelOutputs/results_1kmgrid_date_10years_vg.rds")
```


```{r model3b-results, cache=TRUE}
results_1kmgrid_date_10years_vg <- readRDS("../outputs/modelOutputs/results_1kmgrid_date_10years_vg.rds")
# n species sites
sppModelSumDF[8, 5] <- (results_1kmgrid_date_10years_vg$species_sites) 
# n species observations
sppModelSumDF[8, 6] <- (results_1kmgrid_date_10years_vg$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_1kmgrid_date_10years_vg$BUGSoutput$summary)
sppModelSumDF[8, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[8, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[8, 9] <-(results_1kmgrid_date_10years_vg$BUGSoutput$DIC) 
```

#### Model 3c: Vespa crabro
```{r model3c-crabro, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_1kmgrid_date_10years_vc <- sparta::occDetFunc(taxa_name = "Vespa.crabro",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_1kmgrid_date_10years,
                      spp_vis = spp_vis_merged_1kmgrid_date_10years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_1kmgrid_date_10years_vc, "../outputs/modelOutputs/results_1kmgrid_date_10years_vc.rds")
```


```{r model3c-results, cache=TRUE}
results_1kmgrid_date_10years_vc <- readRDS("../outputs/modelOutputs/results_1kmgrid_date_10years_vc.rds")
# n species sites
sppModelSumDF[9, 5] <- (results_1kmgrid_date_10years_vc$species_sites) 
# n species observations
sppModelSumDF[9, 6] <- (results_1kmgrid_date_10years_vc$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_1kmgrid_date_10years_vc$BUGSoutput$summary)
sppModelSumDF[9, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[9, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[9, 9] <-(results_1kmgrid_date_10years_vc$BUGSoutput$DIC) 
```







## Model 4 (1 yr + 2km^^2)
##### Survey: date (dd/mm/yyyy)
##### Closure period: One year
##### Grid cell: 2x2 km2

### Format
```{r model4-format, echo=TRUE, message=FALSE, warning=FALSE}
######### Format the NHM data #########
formattedOccData_NHM <- sparta::formatOccData(taxa = NHMdat$species, 
                                              site = NHMdat$km2grid, 
                                              survey= paste(NHMdat$km1grid,NHMdat$date),       
                                              closure_period = NHMdat$year)

######### Format the BWARS data #########
formattedOccData_BWARS <- sparta::formatOccData(taxa = BWARSdat$species, 
                                                site = BWARSdat$km2grid, 
                                                survey= paste(BWARSdat$km1grid,BWARSdat$date),
                                                closure_period = BWARSdat$year)

# Change the list length of the formatted NHM data by assigning all values less than 4 (every value because the maximum list length is 3) a value of 10.
formattedOccData_NHM$occDetdata$L[formattedOccData_NHM$occDetdata$L<4] <- 10

# Merge the formated NHM data with the formatted BWARS data. Each contains two list and I will merge the two lists of the two datasets separately. 
occDetdata_merged_2kmgrid_date_year <- rbind(formattedOccData_NHM$occDetdata, formattedOccData_BWARS$occDetdata)
spp_vis_merged_2kmgrid_date_year <- rbind(formattedOccData_NHM$spp_vis, formattedOccData_BWARS$spp_vis)

#Save files
#write.csv(occDetdata_merged_2kmgrid_date_year, '../outputs/formattedData/occDetdata_merged_2kmgrid_date_year.csv')
#write.csv(spp_vis_merged_2kmgrid_date_year, '../outputs/formattedData/spp_vis_merged_2kmgrid_date_year.csv')
```

### Model
Load the formatted data
```{r load-model4-data, cache=TRUE, message=FALSE}
occDetdata_merged_2kmgrid_date_year <- read.csv('../outputs/formattedData/occDetdata_merged_2kmgrid_date_year.csv', header=T, na.strings=c("","NA"))

spp_vis_merged_2kmgrid_date_year <- read.csv('../outputs/formattedData/spp_vis_merged_2kmgrid_date_year.csv', header=T, na.strings=c("","NA"))
```

#### Model 4a: Vespula vulgaris
```{r model4a-vulgaris, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_2kmgrid_date_year_vv <- sparta::occDetFunc(taxa_name = "Vespula.vulgaris",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_2kmgrid_date_year,
                      spp_vis = spp_vis_merged_2kmgrid_date_year,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_2kmgrid_date_year_vv, "../outputs/modelOutputs/results_2kmgrid_date_year_vv.rds")
```



```{r model4a-results, cache=TRUE}
results_2kmgrid_date_year_vv <- readRDS("../outputs/modelOutputs/results_2kmgrid_date_year_vv.rds")

# n Closure periods
modelSumDF[4, 4] <-(results_2kmgrid_date_year_vv$max_year)
# n Visits
modelSumDF[4, 5] <-(results_2kmgrid_date_year_vv$nvisits)
# n Sites
modelSumDF[4, 6] <-(results_2kmgrid_date_year_vv$nsites)


### Species results (sppModelSumDF)
# n species sites
sppModelSumDF[10, 5] <- (results_2kmgrid_date_year_vv$species_sites) 
# n species observations
sppModelSumDF[10, 6] <- (results_2kmgrid_date_year_vv$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_2kmgrid_date_year_vv$BUGSoutput$summary)
sppModelSumDF[10, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 1.528821
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[10, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 7.961708
#DIC
sppModelSumDF[10, 9] <-(results_2kmgrid_date_year_vv$BUGSoutput$DIC) 
```


#### Model 4b: Vespula germanica
```{r model4b-germanica, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_2kmgrid_date_year_vg <- sparta::occDetFunc(taxa_name = "Vespula.germanica",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_2kmgrid_date_year,
                      spp_vis = spp_vis_merged_2kmgrid_date_year,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_2kmgrid_date_year_vg, "../outputs/modelOutputs/results_2kmgrid_date_year_vg.rds")
```


```{r model4b-results, echo=TRUE, cache=TRUE}
results_2kmgrid_date_year_vg <- readRDS("../outputs/modelOutputs/results_2kmgrid_date_year_vg.rds")
### Species results (sppModelSumDF)
# n species sites
sppModelSumDF[11, 5] <- (results_2kmgrid_date_year_vg$species_sites) 
# n species observations
sppModelSumDF[11, 6] <- (results_2kmgrid_date_year_vg$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_2kmgrid_date_year_vg$BUGSoutput$summary)
sppModelSumDF[11, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[11, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[11, 9] <-(results_2kmgrid_date_year_vg$BUGSoutput$DIC) 
```


#### Model 4c: Vespa crabro
```{r model4c-crabro, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_2kmgrid_date_year_vc <- sparta::occDetFunc(taxa_name = "Vespa.crabro",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_2kmgrid_date_year,
                      spp_vis = spp_vis_merged_2kmgrid_date_year,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_2kmgrid_date_year_vc, "../outputs/modelOutputs/results_2kmgrid_date_year_vc.rds")
```


```{r model4c-results, echo=TRUE, cache=TRUE}
results_2kmgrid_date_year_vc <- readRDS("../outputs/modelOutputs/results_2kmgrid_date_year_vc.rds")
# n species sites
sppModelSumDF[12, 5] <- (results_2kmgrid_date_year_vc$species_sites) 
# n species observations
sppModelSumDF[12, 6] <- (results_2kmgrid_date_year_vc$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_2kmgrid_date_year_vc$BUGSoutput$summary)
sppModelSumDF[12, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[12, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[12, 9] <-(results_2kmgrid_date_year_vc$BUGSoutput$DIC) 
```








## Model 5 (5 yrs + 2km^^2)
##### Survey: date (dd/mm/yyyy)
##### Closure period: Five years
##### Grid cell: 10x10 km2

### Format
```{r model5-format, echo=TRUE, message=FALSE, warning=FALSE}
############# Format the NHM data #############
formattedOccData_NHM <- sparta::formatOccData(taxa = NHMdat$species, 
                                              site = NHMdat$km2grid, 
                                              survey= paste(NHMdat$km1grid,NHMdat$date),            
                                              closure_period = NHMdat$tp5)


############# Format the BWARS data #############
formattedOccData_BWARS <- sparta::formatOccData(taxa = BWARSdat$species, 
                                                site = BWARSdat$km2grid, 
                                                survey= paste(BWARSdat$km1grid,BWARSdat$date),
                                                closure_period = BWARSdat$tp5)


# Change the list length of the formatted NHM data bu assigning all values less than 4 (every value because the maximum list length is 3) a value of 10.
formattedOccData_NHM$occDetdata$L[formattedOccData_NHM$occDetdata$L<4] <- 10


# Merge the formated NHM data with the formatted BWARS data. Each contains two list and I will merge the two lists of the two datasets separately. 
occDetdata_merged_2kmgrid_date_5years <- rbind(formattedOccData_NHM$occDetdata, formattedOccData_BWARS$occDetdata)
spp_vis_merged_2kmgrid_date_5years <- rbind(formattedOccData_NHM$spp_vis, formattedOccData_BWARS$spp_vis)

#Save files
#write.csv(occDetdata_merged_2kmgrid_date_5years, '../outputs/formattedData/occDetdata_merged_2kmgrid_date_5years.csv')
#write.csv(spp_vis_merged_2kmgrid_date_5years, '../outputs/formattedData/spp_vis_merged_2kmgrid_date_5years.csv')
```

### Model

Load the formatted data
```{r load-model5-data, cache=TRUE, message=FALSE}
# Load data
occDetdata_merged_2kmgrid_date_5years <- read.csv('../outputs/formattedData/occDetdata_merged_2kmgrid_date_5years.csv', header=T, na.strings=c("","NA"))

spp_vis_merged_2kmgrid_date_5years <- read.csv('../outputs/formattedData/spp_vis_merged_2kmgrid_date_5years.csv', header=T, na.strings=c("","NA"))
```

#### Model 5a: Vespula vulgaris
```{r model5a-vulgaris, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_2kmgrid_date_5years_vv <- sparta::occDetFunc(taxa_name = "Vespula.vulgaris",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_2kmgrid_date_5years,
                      spp_vis = spp_vis_merged_2kmgrid_date_5years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_2kmgrid_date_5years_vv, "../outputs/modelOutputs/results_2kmgrid_date_5years_vv.rds")
```



```{r model5a-results, cache=TRUE}
results_2kmgrid_date_5years_vv <- readRDS("../outputs/modelOutputs/results_2kmgrid_date_5years_vv.rds")
# n Closure periods
modelSumDF[5, 4] <-(results_2kmgrid_date_5years_vv$max_year)
# n Visits
modelSumDF[5, 5] <-(results_2kmgrid_date_5years_vv$nvisits)
# n Sites
modelSumDF[5, 6] <-(results_2kmgrid_date_5years_vv$nsites)


### Species results (sppModelSumDF)
# n species sites
sppModelSumDF[13, 5] <- (results_2kmgrid_date_5years_vv$species_sites) 
# n species observations
sppModelSumDF[13, 6] <- (results_2kmgrid_date_5years_vv$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_2kmgrid_date_5years_vv$BUGSoutput$summary)
sppModelSumDF[13, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 1.528821
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[13, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 7.961708
#DIC
sppModelSumDF[13, 9] <-(results_2kmgrid_date_5years_vv$BUGSoutput$DIC) 
```


#### Model 5b: Vespula germanica
```{r model5b-germanica, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_2kmgrid_date_5years_vg <- sparta::occDetFunc(taxa_name = "Vespula.germanica",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_2kmgrid_date_5years,
                      spp_vis = spp_vis_merged_2kmgrid_date_5years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_2kmgrid_date_5years_vg, "../outputs/modelOutputs/results_2kmgrid_date_5years_vg.rds")
```


```{r model5b-results, cache=TRUE}
results_2kmgrid_date_5years_vg <- readRDS("../outputs/modelOutputs/results_2kmgrid_date_5years_vg.rds")
# n species sites
sppModelSumDF[14, 5] <- (results_2kmgrid_date_5years_vg$species_sites) 
# n species observations
sppModelSumDF[14, 6] <- (results_2kmgrid_date_5years_vg$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_2kmgrid_date_5years_vg$BUGSoutput$summary)
sppModelSumDF[14, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[14, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[14, 9] <-(results_2kmgrid_date_5years_vg$BUGSoutput$DIC) 

```


#### Model 5c: Vespa crabro
```{r model5c-crabro, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_2kmgrid_date_5years_vc <- sparta::occDetFunc(taxa_name = "Vespa.crabro",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_2kmgrid_date_5years,
                      spp_vis = spp_vis_merged_2kmgrid_date_5years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_2kmgrid_date_5years_vc, "../outputs/modelOutputs/results_2kmgrid_date_5years_vc.rds")
```


```{r model5c-results, echo=TRUE, cache=TRUE}
results_2kmgrid_date_5years_vc <- readRDS("../outputs/modelOutputs/results_2kmgrid_date_5years_vc.rds")
# n species sites
sppModelSumDF[15, 5] <- (results_2kmgrid_date_5years_vc$species_sites) 
# n species observations
sppModelSumDF[15, 6] <- (results_2kmgrid_date_5years_vc$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_2kmgrid_date_5years_vc$BUGSoutput$summary)
sppModelSumDF[15, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[15, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[15, 9] <-(results_2kmgrid_date_5years_vc$BUGSoutput$DIC) 
```



## Model 6 (10 yrs + 2km^^2)
##### Survey: date (dd/mm/yyyy)
##### Closure period: ten years
##### Grid cell: 2x2 km

### Format
```{r model6-format, echo=TRUE, message=FALSE, warning=FALSE}
############# Format the NHM data #############
formattedOccData_NHM <- sparta::formatOccData(taxa = NHMdat$species, 
                                              site = NHMdat$km2grid, 
                                              survey= paste(NHMdat$km1grid,NHMdat$date),            
                                              closure_period = NHMdat$tp10)


############# Format the BWARS data #############
formattedOccData_BWARS <- sparta::formatOccData(taxa = BWARSdat$species, 
                                                site = BWARSdat$km2grid, 
                                                survey= paste(BWARSdat$km1grid,BWARSdat$date),
                                                closure_period = BWARSdat$tp10)


# Change the list length of the formatted NHM data bu assigning all values less than 4 (every value because the maximum list length is 3) a value of 10.
formattedOccData_NHM$occDetdata$L[formattedOccData_NHM$occDetdata$L<4] <- 10


# Merge the formated NHM data with the formatted BWARS data. Each contains two list and I will merge the two lists of the two datasets separately. 
occDetdata_merged_2kmgrid_date_10years <- rbind(formattedOccData_NHM$occDetdata, formattedOccData_BWARS$occDetdata)
spp_vis_merged_2kmgrid_date_10years <- rbind(formattedOccData_NHM$spp_vis, formattedOccData_BWARS$spp_vis)

#Save files
#write.csv(occDetdata_merged_2kmgrid_date_10years, '../outputs/formattedData/occDetdata_merged_2kmgrid_date_10years.csv')
#write.csv(spp_vis_merged_2kmgrid_date_10years, '../outputs/formattedData/spp_vis_merged_2kmgrid_date_10years.csv')
```

### Model

Load the formatted data
```{r load-model6-data, cache=TRUE, message=FALSE}
# Load data
occDetdata_merged_2kmgrid_date_10years <- read.csv('../outputs/formattedData/occDetdata_merged_2kmgrid_date_10years.csv', header=T, na.strings=c("","NA"))

spp_vis_merged_2kmgrid_date_10years <- read.csv('../outputs/formattedData/spp_vis_merged_2kmgrid_date_10years.csv', header=T, na.strings=c("","NA"))
```

#### Model 6a: Vespula vulgaris
```{r model6a-vulgaris, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_2kmgrid_date_10years_vv <- sparta::occDetFunc(taxa_name = "Vespula.vulgaris",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_2kmgrid_date_10years,
                      spp_vis = spp_vis_merged_2kmgrid_date_10years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_2kmgrid_date_10years_vv, "../outputs/modelOutputs/results_2kmgrid_date_10years_vv.rds")
```



```{r model6a-results, echo=TRUE, cache=TRUE}
# Load data
results_2kmgrid_date_10years_vv <- readRDS("../outputs/modelOutputs/results_2kmgrid_date_10years_vv.rds")

# n Closure periods
modelSumDF[6, 4] <-(results_2kmgrid_date_10years_vv$max_year)
# n Visits
modelSumDF[6, 5] <-(results_2kmgrid_date_10years_vv$nvisits)
# n Sites
modelSumDF[6, 6] <-(results_2kmgrid_date_10years_vv$nsites)


### Species results (sppModelSumDF)
# n species sites
sppModelSumDF[16, 5] <- (results_2kmgrid_date_10years_vv$species_sites) 
# n species observations
sppModelSumDF[16, 6] <- (results_2kmgrid_date_10years_vv$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_2kmgrid_date_10years_vv$BUGSoutput$summary)
sppModelSumDF[16, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 1.528821
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[16, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 7.961708
#DIC
sppModelSumDF[16, 9] <-(results_2kmgrid_date_10years_vv$BUGSoutput$DIC) 


```



#### Model 6b: Vespula germanica
```{r model6b-germanica, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_2kmgrid_date_10years_vg <- sparta::occDetFunc(taxa_name = "Vespula.germanica",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_2kmgrid_date_10years,
                      spp_vis = spp_vis_merged_2kmgrid_date_10years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_2kmgrid_date_10years_vg, "../outputs/modelOutputs/results_2kmgrid_date_10years_vg.rds")
```

```{r model6b-results, cache=TRUE}
#Load model output
results_2kmgrid_date_10years_vg <- readRDS("../outputs/modelOutputs/results_2kmgrid_date_10years_vg.rds")

# n species sites
sppModelSumDF[17, 5] <- (results_2kmgrid_date_10years_vg$species_sites) 
# n species observations
sppModelSumDF[17, 6] <- (results_2kmgrid_date_10years_vg$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_2kmgrid_date_10years_vg$BUGSoutput$summary)
sppModelSumDF[17, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[17, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[17, 9] <-(results_2kmgrid_date_10years_vg$BUGSoutput$DIC) 

```





#### Model 6c: Vespa crabro
```{r model6c-crabro, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_2kmgrid_date_10years_vc <- sparta::occDetFunc(taxa_name = "Vespa.crabro",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_2kmgrid_date_10years,
                      spp_vis = spp_vis_merged_2kmgrid_date_10years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_2kmgrid_date_10years_vc, "../outputs/modelOutputs/results_2kmgrid_date_10years_vc.rds")
```


```{r model6c-results, cache=TRUE}
#Load Model output
results_2kmgrid_date_10years_vc <- readRDS("../outputs/modelOutputs/results_2kmgrid_date_10years_vc.rds")
# n species sites
sppModelSumDF[18, 5] <- (results_2kmgrid_date_10years_vc$species_sites) 
# n species observations
sppModelSumDF[18, 6] <- (results_2kmgrid_date_10years_vc$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_2kmgrid_date_10years_vc$BUGSoutput$summary)
sppModelSumDF[18, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[18, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[18, 9] <-(results_2kmgrid_date_10years_vc$BUGSoutput$DIC) 
```



## Model 7 (1 yr + 5km^^2)
##### Survey: date (dd/mm/yyyy)
##### Closure period: one year
##### Grid cell: 5x5 km

### Format 
```{r model7-format, echo=TRUE, message=FALSE, warning=FALSE}
######### Format the NHM data #########
formattedOccData_NHM <- sparta::formatOccData(taxa = NHMdat$species, 
                                              site = NHMdat$km5grid, 
                                              survey= paste(NHMdat$km1grid,NHMdat$date),       
                                              closure_period = NHMdat$year)

######### Format the BWARS data #########
formattedOccData_BWARS <- sparta::formatOccData(taxa = BWARSdat$species, 
                                                site = BWARSdat$km5grid, 
                                                survey= paste(BWARSdat$km1grid,BWARSdat$date),
                                                closure_period = BWARSdat$year)

# Change the list length of the formatted NHM data bu assigning all values less than 4 (every value because the maximum list length is 3) a value of 10.
formattedOccData_NHM$occDetdata$L[formattedOccData_NHM$occDetdata$L<4] <- 10

# Merge the formated NHM data with the formatted BWARS data. Each contains two list and I will merge the two lists of the two datasets separately. 
occDetdata_merged_5kmgrid_date_year <- rbind(formattedOccData_NHM$occDetdata, formattedOccData_BWARS$occDetdata)
spp_vis_merged_5kmgrid_date_year <- rbind(formattedOccData_NHM$spp_vis, formattedOccData_BWARS$spp_vis)

#Save files
#write.csv(occDetdata_merged_5kmgrid_date_year, '../outputs/formattedData/occDetdata_merged_5kmgrid_date_year.csv')
#write.csv(spp_vis_merged_5kmgrid_date_year, '../outputs/formattedData/spp_vis_merged_5kmgrid_date_year.csv')
```

### Model
Load the formatted data
```{r load-model7-data, cache=TRUE, message=FALSE}
# Load data
occDetdata_merged_5kmgrid_date_year <- read.csv('../outputs/formattedData/occDetdata_merged_5kmgrid_date_year.csv', header=T, na.strings=c("","NA"))

spp_vis_merged_5kmgrid_date_year <- read.csv('../outputs/formattedData/spp_vis_merged_5kmgrid_date_year.csv', header=T, na.strings=c("","NA"))
```

#### Model 7a: Vespula vulgaris
```{r model7a-vulgaris, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_5kmgrid_date_year_vv <- sparta::occDetFunc(taxa_name = "Vespula.vulgaris",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_5kmgrid_date_year,
                      spp_vis = spp_vis_merged_5kmgrid_date_year,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_5kmgrid_date_year_vv, "../outputs/modelOutputs/results_5kmgrid_date_year_vv.rds")
```


```{r model7a-results, cache=TRUE}
results_5kmgrid_date_year_vv <- readRDS("../outputs/modelOutputs/results_5kmgrid_date_year_vv.rds")
# n Closure periods
modelSumDF[7, 4] <-(results_5kmgrid_date_year_vv$max_year)
# n Visits
modelSumDF[7, 5] <-(results_5kmgrid_date_year_vv$nvisits)
# n Sites
modelSumDF[7, 6] <-(results_5kmgrid_date_year_vv$nsites)


### Species results (sppModelSumDF)
# n species sites
sppModelSumDF[19, 5] <- (results_5kmgrid_date_year_vv$species_sites) 
# n species observations
sppModelSumDF[19, 6] <- (results_5kmgrid_date_year_vv$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_5kmgrid_date_year_vv$BUGSoutput$summary)
sppModelSumDF[19, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 1.528821
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[19, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 7.961708
#DIC
sppModelSumDF[19, 9] <-(results_5kmgrid_date_year_vv$BUGSoutput$DIC) 
```


#### Model 7b: Vespula germanica
```{r model7b-germanica, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_5kmgrid_date_year_vg <- sparta::occDetFunc(taxa_name = "Vespula.germanica",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_5kmgrid_date_year,
                      spp_vis = spp_vis_merged_5kmgrid_date_year,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_5kmgrid_date_year_vg, "../outputs/modelOutputs/results_5kmgrid_date_year_vg.rds")
```


```{r model7b-results, cache=TRUE}
results_5kmgrid_date_year_vg <- readRDS("../outputs/modelOutputs/results_5kmgrid_date_year_vg.rds")
# n species sites
sppModelSumDF[20, 5] <- (results_5kmgrid_date_year_vg$species_sites) 
# n species observations
sppModelSumDF[20, 6] <- (results_5kmgrid_date_year_vg$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_5kmgrid_date_year_vg$BUGSoutput$summary)
sppModelSumDF[20, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[20, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[20, 9] <-(results_5kmgrid_date_year_vg$BUGSoutput$DIC) 
```


#### Model 7c: Vespa crabro
```{r model7c-crabro, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_5kmgrid_date_year_vc <- sparta::occDetFunc(taxa_name = "Vespa.crabro",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_5kmgrid_date_year,
                      spp_vis = spp_vis_merged_5kmgrid_date_year,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_5kmgrid_date_year_vc, "../outputs/modelOutputs/results_5kmgrid_date_year_vc.rds")
```


```{r model7c-results, echo=TRUE, cache=TRUE}
results_5kmgrid_date_year_vc <- readRDS("../outputs/modelOutputs/results_5kmgrid_date_year_vc.rds")
# n species sites
sppModelSumDF[21, 5] <- (results_5kmgrid_date_year_vc$species_sites) 
# n species observations
sppModelSumDF[21, 6] <- (results_5kmgrid_date_year_vc$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_5kmgrid_date_year_vc$BUGSoutput$summary)
sppModelSumDF[21, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[21, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[21, 9] <-(results_5kmgrid_date_year_vc$BUGSoutput$DIC) 
```


## Model 8 (5 yrs + 5km^^2)
##### Survey: date (dd/mm/yyyy)
##### Closure period: Five years
##### Grid cell: 5x5 km
### Format 
```{r model8-format, echo=TRUE, message=FALSE, warning=FALSE}
######### Format the NHM data #########
formattedOccData_NHM <- sparta::formatOccData(taxa = NHMdat$species, 
                                              site = NHMdat$km5grid, 
                                              survey= paste(NHMdat$km1grid,NHMdat$date),       
                                              closure_period = NHMdat$tp5)

######### Format the BWARS data #########
formattedOccData_BWARS <- sparta::formatOccData(taxa = BWARSdat$species, 
                                                site = BWARSdat$km5grid, 
                                                survey= paste(BWARSdat$km1grid,BWARSdat$date),
                                                closure_period = BWARSdat$tp5)

# Change the list length of the formatted NHM data bu assigning all values less than 4 (every value because the maximum list length is 3) a value of 10.
formattedOccData_NHM$occDetdata$L[formattedOccData_NHM$occDetdata$L<4] <- 10

# Merge the formated NHM data with the formatted BWARS data. Each contains two list and I will merge the two lists of the two datasets separately. 
occDetdata_merged_5kmgrid_date_5years <- rbind(formattedOccData_NHM$occDetdata, formattedOccData_BWARS$occDetdata)
spp_vis_merged_5kmgrid_date_5years <- rbind(formattedOccData_NHM$spp_vis, formattedOccData_BWARS$spp_vis)

#Save files
#write.csv(occDetdata_merged_5kmgrid_date_5years, '../outputs/formattedData/occDetdata_merged_5kmgrid_date_5years.csv')
#write.csv(spp_vis_merged_5kmgrid_date_5years, '../outputs/formattedData/spp_vis_merged_5kmgrid_date_5years.csv')
```

### Model
Load the formatted data
```{r load-model8-data, cache=TRUE, message=FALSE}
# Load data
occDetdata_merged_5kmgrid_date_5years <- read.csv('../outputs/formattedData/occDetdata_merged_5kmgrid_date_5years.csv', header=T, na.strings=c("","NA"))

spp_vis_merged_5kmgrid_date_5years <- read.csv('../outputs/formattedData/spp_vis_merged_5kmgrid_date_5years.csv', header=T, na.strings=c("","NA"))
```

#### Model 8a: Vespula vulgaris
```{r model8a-vulgaris, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_5kmgrid_date_5years_vv <- sparta::occDetFunc(taxa_name = "Vespula.vulgaris",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_5kmgrid_date_5years,
                      spp_vis = spp_vis_merged_5kmgrid_date_5years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_5kmgrid_date_5years_vv, "../outputs/modelOutputs/results_5kmgrid_date_5years_vv.rds")
```



```{r model8a-results, echo=TRUE, cache=TRUE}
# Load model output
results_5kmgrid_date_5years_vv <- readRDS("../outputs/modelOutputs/results_5kmgrid_date_5years_vv.rds")

# n Closure periods
modelSumDF[8, 4] <-(results_5kmgrid_date_5years_vv$max_year)
# n Visits
modelSumDF[8, 5] <-(results_5kmgrid_date_5years_vv$nvisits)
# n Sites
modelSumDF[8, 6] <-(results_5kmgrid_date_5years_vv$nsites)


### Species results (sppModelSumDF)
# n species sites
sppModelSumDF[22, 5] <- (results_5kmgrid_date_5years_vv$species_sites) 
# n species observations
sppModelSumDF[22, 6] <- (results_5kmgrid_date_5years_vv$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_5kmgrid_date_5years_vv$BUGSoutput$summary)
sppModelSumDF[22, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 1.528821
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[22, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 7.961708
#DIC
sppModelSumDF[22, 9] <-(results_5kmgrid_date_5years_vv$BUGSoutput$DIC) 
```


#### Model 8b: Vespula germanica
```{r model8b-germanica, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_5kmgrid_date_5years_vg <- sparta::occDetFunc(taxa_name = "Vespula.germanica",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_5kmgrid_date_5years,
                      spp_vis = spp_vis_merged_5kmgrid_date_5years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_5kmgrid_date_5years_vg, "../outputs/modelOutputs/results_5kmgrid_date_5years_vg.rds")
```

```{r model8b-results, cache=TRUE}
#Load model output
results_5kmgrid_date_5years_vg <- readRDS("../outputs/modelOutputs/results_5kmgrid_date_5years_vg.rds")
# n species sites
sppModelSumDF[23, 5] <- (results_5kmgrid_date_5years_vg$species_sites) 
# n species observations
sppModelSumDF[23, 6] <- (results_5kmgrid_date_5years_vg$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_5kmgrid_date_5years_vg$BUGSoutput$summary)
sppModelSumDF[23, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[23, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[23, 9] <-(results_5kmgrid_date_5years_vg$BUGSoutput$DIC) 
```


#### Model 8c: Vespa crabro
```{r model8c-crabro, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_5kmgrid_date_5years_vc <- sparta::occDetFunc(taxa_name = "Vespa.crabro",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_5kmgrid_date_5years,
                      spp_vis = spp_vis_merged_5kmgrid_date_5years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_5kmgrid_date_5years_vc, "../outputs/modelOutputs/results_5kmgrid_date_5years_vc.rds")
```


```{r model8c-results, cache=TRUE}
#Load Model output
results_5kmgrid_date_5years_vc <- readRDS("../outputs/modelOutputs/results_5kmgrid_date_5years_vc.rds")

# n species sites
sppModelSumDF[24, 5] <- (results_5kmgrid_date_5years_vc$species_sites) 
# n species observations
sppModelSumDF[24, 6] <- (results_5kmgrid_date_5years_vc$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_5kmgrid_date_5years_vc$BUGSoutput$summary)
sppModelSumDF[24, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[24, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[24, 9] <-(results_5kmgrid_date_5years_vc$BUGSoutput$DIC) 
```




## Model 9 (10 yrs + 5km^^2)
##### Survey: date (dd/mm/yyyy)
##### Closure period: ten years
##### Grid cell: 5x5 km

### Format 
```{r model9-format, echo=TRUE, message=FALSE, warning=FALSE}
######### Format the NHM data #########
formattedOccData_NHM <- sparta::formatOccData(taxa = NHMdat$species, 
                                              site = NHMdat$km5grid, 
                                              survey= paste(NHMdat$km1grid,NHMdat$date),       
                                              closure_period = NHMdat$tp10)

######### Format the BWARS data #########
formattedOccData_BWARS <- sparta::formatOccData(taxa = BWARSdat$species, 
                                                site = BWARSdat$km5grid, 
                                                survey= paste(BWARSdat$km1grid,BWARSdat$date),
                                                closure_period = BWARSdat$tp10)

# Change the list length of the formatted NHM data bu assigning all values less than 4 (every value because the maximum list length is 3) a value of 10.
formattedOccData_NHM$occDetdata$L[formattedOccData_NHM$occDetdata$L<4] <- 10

# Merge the formated NHM data with the formatted BWARS data. Each contains two list and I will merge the two lists of the two datasets separately. 
occDetdata_merged_5kmgrid_date_10years <- rbind(formattedOccData_NHM$occDetdata, formattedOccData_BWARS$occDetdata)
spp_vis_merged_5kmgrid_date_10years <- rbind(formattedOccData_NHM$spp_vis, formattedOccData_BWARS$spp_vis)

#Save files
#write.csv(occDetdata_merged_5kmgrid_date_10years, '../outputs/formattedData/occDetdata_merged_5kmgrid_date_10years.csv')
#write.csv(spp_vis_merged_5kmgrid_date_10years, '../outputs/formattedData/spp_vis_merged_5kmgrid_date_10years.csv')
```

### Model
Load the formatted data
```{r load-model9-data, cache=TRUE, message=FALSE}
# Load data
occDetdata_merged_5kmgrid_date_10years <- read.csv('../outputs/formattedData/occDetdata_merged_5kmgrid_date_10years.csv', header=T, na.strings=c("","NA"))

spp_vis_merged_5kmgrid_date_10years <- read.csv('../outputs/formattedData/spp_vis_merged_5kmgrid_date_10years.csv', header=T, na.strings=c("","NA"))
```

#### Model 9a: Vespula vulgaris
```{r model9a-vulgaris, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_5kmgrid_date_10years_vv <- sparta::occDetFunc(taxa_name = "Vespula.vulgaris",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_5kmgrid_date_10years,
                      spp_vis = spp_vis_merged_5kmgrid_date_10years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_5kmgrid_date_10years_vv, "../outputs/modelOutputs/results_5kmgrid_date_10years_vv.rds")
```



```{r model9a-results, cache=TRUE}
#Load model output
results_5kmgrid_date_10years_vv <- readRDS("../outputs/modelOutputs/results_5kmgrid_date_10years_vv.rds")

# n Closure periods
modelSumDF[9, 4] <-(results_5kmgrid_date_10years_vv$max_year)
# n Visits
modelSumDF[9, 5] <-(results_5kmgrid_date_10years_vv$nvisits)
# n Sites
modelSumDF[9, 6] <-(results_5kmgrid_date_10years_vv$nsites)


### Species results (sppModelSumDF)
# n species sites
sppModelSumDF[25, 5] <- (results_5kmgrid_date_10years_vv$species_sites) 
# n species observations
sppModelSumDF[25, 6] <- (results_5kmgrid_date_10years_vv$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_5kmgrid_date_10years_vv$BUGSoutput$summary)
sppModelSumDF[25, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 1.528821
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[25, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 7.961708
#DIC
sppModelSumDF[25, 9] <-(results_5kmgrid_date_10years_vv$BUGSoutput$DIC) 
```



#### Model 9b: Vespula germanica
```{r model9b-germanica, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_5kmgrid_date_10years_vg <- sparta::occDetFunc(taxa_name = "Vespula.germanica",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_5kmgrid_date_10years,
                      spp_vis = spp_vis_merged_5kmgrid_date_10years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_5kmgrid_date_10years_vg, "../outputs/modelOutputs/results_5kmgrid_date_10years_vg.rds")
```


```{r model9b-results, cache=TRUE}
#Load model output
results_5kmgrid_date_10years_vg <- readRDS("../outputs/modelOutputs/results_5kmgrid_date_10years_vg.rds")

# n species sites
sppModelSumDF[26, 5] <- (results_5kmgrid_date_10years_vg$species_sites) 
# n species observations
sppModelSumDF[26, 6] <- (results_5kmgrid_date_10years_vg$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_5kmgrid_date_10years_vg$BUGSoutput$summary)
sppModelSumDF[26, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[26, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[26, 9] <-(results_5kmgrid_date_10years_vg$BUGSoutput$DIC) 
```





#### Model 9c: Vespa crabro
```{r model9c-crabro, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_5kmgrid_date_10years_vc <- sparta::occDetFunc(taxa_name = "Vespa.crabro",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_5kmgrid_date_10years,
                      spp_vis = spp_vis_merged_5kmgrid_date_10years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_5kmgrid_date_10years_vc, "../outputs/modelOutputs/results_5kmgrid_date_10years_vc.rds")
```



```{r model9c-results, cache=TRUE}
#Load model output
results_5kmgrid_date_10years_vc <- readRDS("../outputs/modelOutputs/results_5kmgrid_date_10years_vc.rds")

# n species sites
sppModelSumDF[27, 5] <- (results_5kmgrid_date_10years_vc$species_sites) 
# n species observations
sppModelSumDF[27, 6] <- (results_5kmgrid_date_10years_vc$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_5kmgrid_date_10years_vc$BUGSoutput$summary)
sppModelSumDF[27, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[27, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[27, 9] <-(results_5kmgrid_date_10years_vc$BUGSoutput$DIC) 
```




## Model 10 (1 yr + 10km^^2)
##### Survey: date (dd/mm/yyyy)
##### Closure period: One year
##### Grid cell: 10x10 km

### Format
```{r model10-format, message=FALSE, warning=FALSE}
############# Format the NHM data #############
formattedOccData_NHM <- sparta::formatOccData(taxa = NHMdat$species, 
                                              site = NHMdat$km10grid, 
                                              survey= paste(NHMdat$km1grid,NHMdat$date), 
                                              closure_period = NHMdat$year)

######### Format the BWARS data #########
formattedOccData_BWARS <- sparta::formatOccData(taxa = BWARSdat$species, 
                                                site = BWARSdat$km10grid, 
                                                survey= paste(BWARSdat$km1grid,BWARSdat$date),
                                                closure_period = BWARSdat$year)


# Change the list length of the formatted NHM data bu assigning all values less than 4 (every value because the maximum list length is 3) a value of 10.
formattedOccData_NHM$occDetdata$L[formattedOccData_NHM$occDetdata$L<4] <- 10

# Merge the formated NHM data with the formatted BWARS data. Each contains two list and I will merge the two lists of the two datasets separately. 
occDetdata_merged_10kmgrid_date_year <- rbind(formattedOccData_NHM$occDetdata, formattedOccData_BWARS$occDetdata)
spp_vis_merged_10kmgrid_date_year <- rbind(formattedOccData_NHM$spp_vis, formattedOccData_BWARS$spp_vis)

#Save files
#write.csv(occDetdata_merged_10kmgrid_date_year, '../outputs/formattedData/occDetdata_merged_5kmgrid_date_year.csv')
#write.csv(spp_vis_merged_10kmgrid_date_year, '../outputs/formattedData/spp_vis_merged_5kmgrid_date_year.csv')
```


### Model
Load the formatted data
```{r load-model10-data, cache=TRUE, message=FALSE}
occDetdata_merged_10kmgrid_date_year <- read.csv('../outputs/formattedData/occDetdata_merged_10kmgrid_date_year.csv', header=T, na.strings=c("","NA"))

spp_vis_merged_10kmgrid_date_year <- read.csv('../outputs/formattedData/spp_vis_merged_10kmgrid_date_year.csv', header=T, na.strings=c("","NA"))
```

### Model 10a: Vespula vulgaris
```{r model10a-vulgaris, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_10kmgrid_date_year_vv <- sparta::occDetFunc(taxa_name = "Vespula.vulgaris",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_10kmgrid_date_year,
                      spp_vis = spp_vis_merged_10kmgrid_date_year,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_10kmgrid_date_year_vv, "../outputs/modelOutputs/results_10kmgrid_date_year_vv.rds")
```


```{r model10a-results, cache=TRUE}
# Load data
results_10kmgrid_date_year_vv <- readRDS("../outputs/modelOutputs/results_10kmgrid_date_year_vv.rds")

# n Closure periods
modelSumDF[10, 4] <-(results_10kmgrid_date_year_vv$max_year)
# n Visits
modelSumDF[10, 5] <-(results_10kmgrid_date_year_vv$nvisits)
# n Sites
modelSumDF[10, 6] <-(results_10kmgrid_date_year_vv$nsites)


### Species results (sppModelSumDF)
# n species sites
sppModelSumDF[28, 5] <- (results_10kmgrid_date_year_vv$species_sites) 
# n species observations
sppModelSumDF[28, 6] <- (results_10kmgrid_date_year_vv$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_10kmgrid_date_year_vv$BUGSoutput$summary)
sppModelSumDF[28, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 1.528821
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[28, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 7.961708
#DIC
sppModelSumDF[28, 9] <-(results_10kmgrid_date_year_vv$BUGSoutput$DIC) 

```


#### Model 10b: Vespula germanica
```{r model10b-germanica, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_10kmgrid_date_year_vg <- sparta::occDetFunc(taxa_name = "Vespula.germanica",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_10kmgrid_date_year,
                      spp_vis = spp_vis_merged_10kmgrid_date_year,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_10kmgrid_date_year_vg, "../outputs/modelOutputs/results_10kmgrid_date_year_vg.rds")
```


```{r model10b-results, cache=TRUE}
results_10kmgrid_date_year_vg <- readRDS("../outputs/modelOutputs/results_10kmgrid_date_year_vg.rds")
# n species sites
sppModelSumDF[29, 5] <- (results_10kmgrid_date_year_vg$species_sites) 
# n species observations
sppModelSumDF[29, 6] <- (results_10kmgrid_date_year_vg$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_10kmgrid_date_year_vg$BUGSoutput$summary)
sppModelSumDF[29, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[29, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[29, 9] <-(results_10kmgrid_date_year_vg$BUGSoutput$DIC) 
```


#### Model 10c: Vespa crabro
```{r model10c-crabro, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_10kmgrid_date_year_vc <- sparta::occDetFunc(taxa_name = "Vespa.crabro",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_10kmgrid_date_year,
                      spp_vis = spp_vis_merged_10kmgrid_date_year,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_10kmgrid_date_year_vc, "../outputs/modelOutputs/results_10kmgrid_date_year_vc.rds")
```



```{r model10c-results, cache=TRUE}
results_10kmgrid_date_year_vc <- readRDS("../outputs/modelOutputs/results_10kmgrid_date_year_vc.rds")
# n species sites
sppModelSumDF[30, 5] <- (results_10kmgrid_date_year_vc$species_sites) 
# n species observations
sppModelSumDF[30, 6] <- (results_10kmgrid_date_year_vc$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_10kmgrid_date_year_vc$BUGSoutput$summary)
sppModelSumDF[30, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[30, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[30, 9] <-(results_10kmgrid_date_year_vc$BUGSoutput$DIC) 
```



## Model 11 (5 yr + 10km^^2)
##### Survey: date (dd/mm/yyyy)
##### Closure period: Five years
##### Grid cell: 10x10 km

### Format
```{r model11-format, message=FALSE, warning=FALSE}
############# Format the NHM data #############
formattedOccData_NHM <- sparta::formatOccData(taxa = NHMdat$species, 
                                              site = NHMdat$km10grid, 
                                              survey= paste(NHMdat$km1grid,NHMdat$date),                                 
                                              closure_period = NHMdat$tp5)

############# Format the BWARS data #############
formattedOccData_BWARS <- sparta::formatOccData(taxa = BWARSdat$species, 
                                                site = BWARSdat$km10grid, 
                                                survey= paste(BWARSdat$km1grid,BWARSdat$date),
                                                closure_period = BWARSdat$tp5)

# Change the list length of the formatted NHM data bu assigning all values less than 4 (every value because the maximum list length is 3) a value of 10.
formattedOccData_NHM$occDetdata$L[formattedOccData_NHM$occDetdata$L<4] <- 10


# Merge the formated NHM data with the formatted BWARS data. Each contains two list and I will merge the two lists of the two datasets separately. 
occDetdata_merged_10kmgrid_date_5years <- rbind(formattedOccData_NHM$occDetdata, formattedOccData_BWARS$occDetdata)
spp_vis_merged_10kmgrid_date_5years <- rbind(formattedOccData_NHM$spp_vis, formattedOccData_BWARS$spp_vis)

#Save files
#write.csv(occDetdata_merged_10kmgrid_date_5years, '../outputs/formattedData/occDetdata_merged_10kmgrid_date_5years.csv')
#write.csv(spp_vis_merged_10kmgrid_date_5years, '../outputs/formattedData/spp_vis_merged_10kmgrid_date_5years.csv')
```

### Model
Load the formatted data
```{r load-model11-data, cache=TRUE, message=FALSE}
# Load data
occDetdata_merged_10kmgrid_date_5years <- read.csv('../outputs/formattedData/occDetdata_merged_10kmgrid_date_5years.csv', header=T, na.strings=c("","NA"))

spp_vis_merged_10kmgrid_date_5years <- read.csv('../outputs/formattedData/spp_vis_merged_10kmgrid_date_5years.csv', header=T, na.strings=c("","NA"))
```

#### Model 11a: Vespula vulgaris
```{r model11a-vulgaris, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_10kmgrid_date_5years_vv <- sparta::occDetFunc(taxa_name = "Vespula.vulgaris",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_10kmgrid_date_5years,
                      spp_vis = spp_vis_merged_10kmgrid_date_5years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_10kmgrid_date_5years_vv, "../outputs/modelOutputs/results_10kmgrid_date_5years_vv.rds")
```



```{r model11a-results, cache=TRUE}
#Load model output
results_10kmgrid_date_5years_vv <- readRDS("../outputs/modelOutputs/results_10kmgrid_date_5years_vv.rds")

# n Closure periods
modelSumDF[11, 4] <-(results_10kmgrid_date_5years_vv$max_year)
# n Visits
modelSumDF[11, 5] <-(results_10kmgrid_date_5years_vv$nvisits)
# n Sites
modelSumDF[11, 6] <-(results_10kmgrid_date_5years_vv$nsites)


### Species results (sppModelSumDF)
# n species sites
sppModelSumDF[31, 5] <- (results_10kmgrid_date_5years_vv$species_sites) 
# n species observations
sppModelSumDF[31, 6] <- (results_10kmgrid_date_5years_vv$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_10kmgrid_date_5years_vv$BUGSoutput$summary)
sppModelSumDF[31, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 1.528821
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[31, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 7.961708
#DIC
sppModelSumDF[31, 9] <-(results_10kmgrid_date_5years_vv$BUGSoutput$DIC) 
```


#### Model 11b: Vespula germanica
```{r model11b-germanica, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_10kmgrid_date_5years_vg <- sparta::occDetFunc(taxa_name = "Vespula.germanica",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_10kmgrid_date_5years,
                      spp_vis = spp_vis_merged_10kmgrid_date_5years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_10kmgrid_date_5years_vg, "../outputs/modelOutputs/results_10kmgrid_date_5years_vg.rds")
```


```{r model11b-results, cache=TRUE}
#Load model output
results_10kmgrid_date_5years_vg <- readRDS("../outputs/modelOutputs/results_10kmgrid_date_5years_vg.rds")

# n species sites
sppModelSumDF[32, 5] <- (results_10kmgrid_date_5years_vg$species_sites) 
# n species observations
sppModelSumDF[32, 6] <- (results_10kmgrid_date_5years_vg$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_10kmgrid_date_5years_vg$BUGSoutput$summary)
sppModelSumDF[32, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[32, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[32, 9] <-(results_10kmgrid_date_5years_vg$BUGSoutput$DIC) 

```


#### Model 11c: Vespa crabro
```{r model11c-crabro, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_10kmgrid_date_5years_vc <- sparta::occDetFunc(taxa_name = "Vespa.crabro",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_10kmgrid_date_5years,
                      spp_vis = spp_vis_merged_10kmgrid_date_5years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_10kmgrid_date_5years_vc, "../outputs/modelOutputs/results_10kmgrid_date_5years_vc.rds")
```



```{r model11c-results, cache=TRUE}
#Load model output
results_10kmgrid_date_5years_vc <- readRDS("../outputs/modelOutputs/results_10kmgrid_date_5years_vc.rds")

# n species sites
sppModelSumDF[33, 5] <- (results_10kmgrid_date_5years_vc$species_sites) 
# n species observations
sppModelSumDF[33, 6] <- (results_10kmgrid_date_5years_vc$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_10kmgrid_date_5years_vc$BUGSoutput$summary)
sppModelSumDF[33, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[33, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[33, 9] <-(results_10kmgrid_date_5years_vc$BUGSoutput$DIC) 

```



## Model 12 (10 yr + 10km^^2)
##### Survey: date (dd/mm/yyyy)
##### Closure period: ten years
##### Grid cell: 10x10 km


### Format
```{r model12-format, echo=TRUE, message=FALSE, warning=FALSE}
############# Format the NHM data #############
formattedOccData_NHM <- sparta::formatOccData(taxa = NHMdat$species, 
                                              site = NHMdat$km10grid, 
                                              survey= paste(NHMdat$km1grid,NHMdat$date),                                 
                                              closure_period = NHMdat$tp10)

############# Format the BWARS data #############
formattedOccData_BWARS <- sparta::formatOccData(taxa = BWARSdat$species, 
                                                site = BWARSdat$km10grid, 
                                                survey= paste(BWARSdat$km1grid,BWARSdat$date),
                                                closure_period = BWARSdat$tp10)

# Change the list length of the formatted NHM data bu assigning all values less than 4 (every value because the maximum list length is 3) a value of 10.
formattedOccData_NHM$occDetdata$L[formattedOccData_NHM$occDetdata$L<4] <- 10


# Merge the formated NHM data with the formatted BWARS data. Each contains two list and I will merge the two lists of the two datasets separately. 
occDetdata_merged_10kmgrid_date_10years <- rbind(formattedOccData_NHM$occDetdata, formattedOccData_BWARS$occDetdata)
spp_vis_merged_10kmgrid_date_10years <- rbind(formattedOccData_NHM$spp_vis, formattedOccData_BWARS$spp_vis)

#Save files
#write.csv(occDetdata_merged_10kmgrid_date_10years, '../outputs/formattedData/occDetdata_merged_10kmgrid_date_10years.csv')
#write.csv(spp_vis_merged_10kmgrid_date_10years, '../outputs/formattedData/spp_vis_merged_10kmgrid_date_10years.csv')
```


### Model
Load the formatted data
```{r load-model12-data, cache=TRUE, message=FALSE}
# Load data
occDetdata_merged_10kmgrid_date_10years <- read.csv('../outputs/formattedData/occDetdata_merged_10kmgrid_date_10years.csv', header=T, na.strings=c("","NA"))

spp_vis_merged_10kmgrid_date_10years <- read.csv('../outputs/formattedData/spp_vis_merged_10kmgrid_date_10years.csv', header=T, na.strings=c("","NA"))
```

#### Model 12a: Vespula vulgaris
```{r model12a-vulgaris, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_10kmgrid_date_10years_vv <- sparta::occDetFunc(taxa_name = "Vespula.vulgaris",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_10kmgrid_date_10years,
                      spp_vis = spp_vis_merged_10kmgrid_date_10years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_10kmgrid_date_10years_vv, "../outputs/modelOutputs/results_10kmgrid_date_10years_vv.rds")
```



```{r model12a-results, echo=TRUE, cache=TRUE}
# Load model outputs
results_10kmgrid_date_10years_vv <- readRDS("../outputs/modelOutputs/results_10kmgrid_date_10years_vv.rds")

# n Closure periods
modelSumDF[12, 4] <-(results_10kmgrid_date_10years_vv$max_year)
# n Visits
modelSumDF[12, 5] <-(results_10kmgrid_date_10years_vv$nvisits)
# n Sites
modelSumDF[12, 6] <-(results_10kmgrid_date_10years_vv$nsites)


### Species results (sppModelSumDF)
# n species sites
sppModelSumDF[34, 5] <- (results_10kmgrid_date_10years_vv$species_sites) 
# n species observations
sppModelSumDF[34, 6] <- (results_10kmgrid_date_10years_vv$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_10kmgrid_date_10years_vv$BUGSoutput$summary)
sppModelSumDF[34, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 1.528821
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[34, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2) # 7.961708
#DIC
sppModelSumDF[34, 9] <-(results_10kmgrid_date_10years_vv$BUGSoutput$DIC) 

```



#### Model 12b: Vespula germanica
```{r model12b-germanica, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_10kmgrid_date_10years_vg <- sparta::occDetFunc(taxa_name = "Vespula.germanica",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_10kmgrid_date_10years,
                      spp_vis = spp_vis_merged_10kmgrid_date_10years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_10kmgrid_date_10years_vg, "../outputs/modelOutputs/results_10kmgrid_date_10years_vg.rds")
```


```{r model12b-results, echo=TRUE, cache=TRUE}
# Load model outputs
results_10kmgrid_date_10years_vg <- readRDS("../outputs/modelOutputs/results_10kmgrid_date_10years_vg.rds")

# n species sites
sppModelSumDF[35, 5] <- (results_10kmgrid_date_10years_vg$species_sites) 
# n species observations
sppModelSumDF[35, 6] <- (results_10kmgrid_date_10years_vg$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_10kmgrid_date_10years_vg$BUGSoutput$summary)
sppModelSumDF[35, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[35, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[35, 9] <-(results_10kmgrid_date_10years_vg$BUGSoutput$DIC) 
```





#### Model 12c: Vespa crabro
```{r model12c-crabro, cache=TRUE, message=FALSE, results='hide', eval=FALSE}
# Run model
results_10kmgrid_date_10years_vc <- sparta::occDetFunc(taxa_name = "Vespa.crabro",
                      n_iterations = 50000,
                      burnin = 25000, 
                      occDetdata = occDetdata_merged_10kmgrid_date_10years,
                      spp_vis = spp_vis_merged_10kmgrid_date_10years,
                      modeltype = c('ranwalk', 'halfcauchy', 'catlistlength'),
                      write_results = FALSE)

# Save results file as an rds file
#saveRDS(results_10kmgrid_date_10years_vc, "../outputs/modelOutputs/results_10kmgrid_date_10years_vc.rds")
```


```{r model12c-results, echo=TRUE, cache=TRUE}
# Load model outputs
results_10kmgrid_date_10years_vc <- readRDS("../outputs/modelOutputs/results_10kmgrid_date_10years_vc.rds")

# n species sites
sppModelSumDF[36, 5] <- (results_10kmgrid_date_10years_vc$species_sites) 
# n species observations
sppModelSumDF[36, 6] <- (results_10kmgrid_date_10years_vc$species_observations) 
# Average alpha precision across years (probability that site i is occupied in year t)
library("boot")
x <- inv.logit(results_10kmgrid_date_10years_vc$BUGSoutput$summary)
sppModelSumDF[36, 7] <- mean(1/(x[grepl(pattern="a\\[", x=dimnames(x)[[1]]), c("sd")])^2) 
# Average alpha.p precision across years (probability of detection at site i in year t on visit v, conditional on that the species true presnece of absence)
sppModelSumDF[36, 8] <- mean(1/(x[grepl(pattern="alpha.p\\[", x=dimnames(x)[[1]]), c("sd")])^2)
#DIC
sppModelSumDF[36, 9] <-(results_10kmgrid_date_10years_vc$BUGSoutput$DIC) 
```






Finally, I save the tables summarising sample sizes
```{r save-tables, cache=TRUE, message=FALSE}
# First, inverse logit alphaPrec and alphaPPrec
sppModelSumDF$alphaPrec <- inv.logit(sppModelSumDF$alphaPrec)
sppModelSumDF$alphaPPrec <- inv.logit(sppModelSumDF$alphaPPrec)

# Save modelSumDF
#write.csv(modelSumDF, '../outputs/SummaryTables/modelSummary.csv')

# Save sppModelSumDF
#write.csv(sppModelSumDF, '../outputs/SummaryTables/sppLevelSummary.csv')
```

